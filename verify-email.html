<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verify Email - DeepLak</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* ... existing styles ... */

        /* Account-specific colors */
        .verification-icon.instructor {
            color: #2575fc; /* Blue for instructors */
        }
        
        .verification-icon.learner {
            color: #6a11cb; /* Purple for learners */
        }
        
        .verify-btn.instructor {
            background: #2575fc;
        }
        
        .verify-btn.learner {
            background: #6a11cb;
        }
        
        .verify-btn:disabled {
            background: #b0b0b0;
            cursor: not-allowed;
        }
        
        .resend-link.disabled {
            color: #999;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="navbar-logo">
            <span class="deep">Deep</span><span class="lak">Lak</span>
        </div>
    </nav>

    <div class="verification-page">
        <div class="verification-header">
            <div class="verification-icon" id="verification-icon">
                <i class="fas fa-envelope"></i>
            </div>
            <h2 class="verification-title">Verify Your Email</h2>
            <p class="verification-subtitle">We've sent a 6-digit code to your email address</p>
            <div class="email-display" id="masked-email">te****@example.com</div>
        </div>
        
        <div class="code-container" id="code-container">
            <!-- Code inputs will be generated here -->
        </div>
        
        <div class="timer-container">
            Code expires in: <span class="timer" id="timer">01:00</span>
        </div>
        
        <div class="resend-link" id="resend-link">
            Didn't receive the code? Resend
        </div>
        
        <button class="verify-btn" id="verify-btn">Verify</button>
        <div class="error-message" id="error-message">Invalid verification code. Please try again.</div>
        <div class="error-message" id="expired-message" style="display: none;">Verification code has expired. Please request a new one.</div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const accountType = urlParams.get('accountType') || 'learner';
            const email = urlParams.get('email') || '';
            
            // Set account-specific styling
            const verificationIcon = document.getElementById('verification-icon');
            const verifyBtn = document.getElementById('verify-btn');
            
            if (accountType === 'instructor') {
                verificationIcon.classList.add('instructor');
                verifyBtn.classList.add('instructor');
            } else {
                verificationIcon.classList.add('learner');
                verifyBtn.classList.add('learner');
            }
            
            const maskEmail = (email) => {
                if (!email) return 'you****@email.com';
                const [name, domain] = email.split('@');
                const maskedName = name.length > 2 
                    ? name.substring(0, 2) + '*'.repeat(name.length - 2) 
                    : name.charAt(0) + '*';
                return `${maskedName}@${domain}`;
            };
            
            document.getElementById('masked-email').textContent = maskEmail(email);
            
            const codeContainer = document.getElementById('code-container');
            for (let i = 0; i < 6; i++) {
                const input = document.createElement('input');
                input.type = 'text';
                input.maxLength = 1;
                input.className = 'code-input';
                input.dataset.index = i;
                codeContainer.appendChild(input);
            }
            
            const inputs = document.querySelectorAll('.code-input');
            
            inputs.forEach((input, index) => {
                input.addEventListener('input', function() {
                    if (this.value) {
                        if (index < inputs.length - 1) {
                            inputs[index + 1].focus();
                        }
                    }
                });
                
                input.addEventListener('keydown', function(e) {
                    if (e.key === 'Backspace' && !this.value && index > 0) {
                        inputs[index - 1].focus();
                    }
                });
            });
            
            inputs[0].focus();
            
            let timeLeft = 60;
            const timerElement = document.getElementById('timer');
            const resendLink = document.getElementById('resend-link');
            const verifyButton = document.getElementById('verify-btn');
            const expiredMessage = document.getElementById('expired-message');
            
            // This would come from your backend in a real application
            const validCode = '123456';
            let codeExpired = false;
            
            const updateTimer = () => {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    timerElement.textContent = '00:00';
                    resendLink.classList.remove('disabled');
                    codeExpired = true;
                    verifyButton.disabled = true;
                    expiredMessage.style.display = 'block';
                } else {
                    timeLeft--;
                }
            };
            
            let timerInterval = setInterval(updateTimer, 1000);
            
            resendLink.addEventListener('click', function() {
                if (this.classList.contains('disabled') || codeExpired) return;
                
                // Simulate resending code
                console.log('Resending verification code to', email);
                alert(`Verification code resent to ${maskEmail(email)}`);
                
                timeLeft = 60;
                clearInterval(timerInterval);
                timerInterval = setInterval(updateTimer, 1000);
                resendLink.classList.add('disabled');
                verifyButton.disabled = false;
                expiredMessage.style.display = 'none';
                codeExpired = false;
                
                inputs.forEach(input => input.value = '');
                inputs[0].focus();
            });
            
            verifyButton.addEventListener('click', function() {
                if (codeExpired) {
                    document.getElementById('error-message').style.display = 'none';
                    expiredMessage.style.display = 'block';
                    return;
                }
                
                let code = '';
                inputs.forEach(input => {
                    code += input.value;
                });
                
                if (code.length === 6 && code === validCode) {
                    window.location.href = `signup-success.html?accountType=${accountType}`;
                } else {
                    document.getElementById('error-message').style.display = 'block';
                    expiredMessage.style.display = 'none';
                }
            });
        });
    </script>
</body>
</html>